# WebLearning-DownloadHelper

## 使用注意事项 :exclamation:

1. 由于我比较菜:shit:，在程序里面用到了selenium，调用了headless chrome，所以需要安装了chrome并且配置了chrome driver才可以正常使用，配置可以参考<https://blog.51cto.com/starpoint/2102975?cid=704621>

2. 在登录之后要点击确定才会开始爬取数据

3. 只需要下载3个`.py`文件或者打包好的exe

   打包程序下载链接：<https://cloud.tsinghua.edu.cn/d/51663ef485bd47aeb85b/>

## 使用库

用到了[Requests: HTTP for Humans](http://www.python-requests.org/en/latest/)和[Selenium](https://www.seleniumhq.org/docs/)

Selenium用于模拟登陆并且获取课程的链接以及cookie以供使用

使用Requests中的session类绑定模拟登陆获得的cookie来进行文件的下载以及其他数据的获取

## 简单的使用说明

> 运行时运行main即可，由于会在运行时在当前目录生成保存用户数据的文件，建议将打包好的exe文件放在一个文件夹中

1. 运行时直接点击登录，如果是初次使用会提示注册，其中输入的内容为THU的id和密码，下载路径为最终将文件下载并生成课程文件夹的路径
2. 点击登录后的提示点击确定，否则不会开始爬取课程信息
3. 之后可能会有大约10s的等待时间，结束之后登录按键会消失，左侧列表显示了所有课程
4. 双击左侧列表的课程会在右侧列表显示文件，选中文件点击下载即可，会在注册时输入的路径生成课程对应的文件夹，下载文件到此文件夹中

## 预期加入的功能:zzz:

**在GUI中加入下拉菜单 ，以自定义设置**

**检测未下载的文件有哪些**

**加入类似购物车的功能**：由于一些视频文件可能不想被下载，所以补全未下载的文件功能可能不太实用，预期加入类似购物车的下载列表，并与检测未下载功能联动，支持将所有未下载的文件加入列表，然后再手动删除不想要的文件

**显示下载进度的功能**

## 补充说明

### 用到Selenium的原因

网络学堂在更新了2018之后，登录过程存在重定向，重定向后cookie也会改变，由于我目前水平较低，暂时无法解决，所以使用了简单但是效率相对低下的Selenium

解决此问题暂时不在目前的更新计划，考虑在夏季学期尝试优化