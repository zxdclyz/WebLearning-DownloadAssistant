# WebLearning-DownloadAssistant

## 使用注意事项 :exclamation::exclamation::exclamation:

1. 由于我比较菜:shit:，在程序里面用到了selenium，调用了headless chrome，所以需要安装了chrome并且配置了chrome driver才可以正常使用，配置可以参考<https://blog.51cto.com/starpoint/2102975?cid=704621>

2. 在登录之后要点击确定才会开始爬取数据

3. 只需要下载3个`.py`文件运行`main.py`或者直接下载打包好的exe文件

   打包文件在github仓库中的release中


## 功能特色

本软件的功能主要为辅助进行清华大学网络学堂2018的课件下载以及分类整理，在网络学堂2018刚推出时，文件下载过程较为复杂，而这款软件支持多选下载，操作方式接近旧版网络学堂，较为亲民，尽管网络学堂2018在二月底的更新中改进了下载方式，这款软件仍具有按照课程自动分类下载的课件的优势（虽然优势没那么明显了让我很不爽就是了），总的来说，就是一款为偷懒而生的懒人软件

## 使用库

用到了[Requests: HTTP for Humans](http://www.python-requests.org/en/latest/)和[Selenium](https://www.seleniumhq.org/docs/)

Selenium用于模拟登陆并且获取课程的链接以及cookie以供使用

使用Requests中的session类绑定模拟登陆获得的cookie来进行文件的下载以及其他数据的获取

## 简单的使用说明:exclamation:

> 运行代码时运行main即可，由于会在运行时在当前目录生成保存用户数据的文件，建议将打包好的exe文件放在一个文件夹中

### 使用流程

1. 运行时直接点击登录，如果是初次使用会提示注册，其中输入的内容为THU的id和密码，下载路径为最终将文件下载并生成课程文件夹的路径
2. 点击登录后的提示点击确定，否则不会开始爬取课程信息
3. 之后可能会有大约5s的等待时间，结束之后登录按键会变成查看列表按键，左侧列表显示了所有课程
4. 双击左侧列表的课程会在下方列表显示文件的分类，再双击文件分类来查看该分类下的文件，该列表中支持多选，选中文件点击`下载`会直接下载，会在注册时输入的路径生成课程对应的文件夹，下载文件到此文件夹中
5. `加入列表`会将选择的文件加入类似购物车的下载列表里，可以在`查看列表`中对其内容进行修改，`列表下载`会下载列表中的所有文件

### 其它按键说明

1. `自动检测`按键的功能为检测网络学堂中**没有在这台电脑上下载过**的文件并将其加入下载列表，使用时会清空已有的下载列表
2. `检测更新`按键功能为自动检测上次使用后网络学堂更新的文件并将其加入下载列表，使用时会清空已有的下载列表
3. `清除列表`按键功能为清空已有的下载列表

### 其他说明

1. 如果点击登录之后没有反应，请确认是否已经安装了Chrome并配置了driver（详情见**使用注意事项**），然后确认您的网络环境良好，可以登录网络学堂
2. 自动检测的功能并不实用（如果不是刚开学就用该软件下载课件），推荐使用检测更新
3. 有些课程，如实验室科研探究，不被该软件支持（懒）
4. 如果您想要更改下载路径，请在exe文件所在目录中找到user_info.json手动修改“path”，请注意`\`不要出错

## 更新计划

- [ ] **在GUI中加入下拉菜单 ，以自定义设置**
  ~~**对应自动检测功能，加入“这个文件我不想下载”的功能**~~（已经通过加入其它功能解决）
- [x] **检测未下载的文件有哪些**
- [ ] **优化自动检测功能**
- [x] **加入类似购物车的功能**：由于一些视频文件可能不想被下载，所以补全未下载的文件功能可能不太实用，预期加入类似购物车的下载列表，并与检测未下载功能联动，支持将所有未下载的文件加入列表，然后再手动删除不想要的文件
  ~~**显示下载进度的功能**~~

## 补充说明

### 用到Selenium的原因

网络学堂在更新了2018之后，登录过程存在重定向，重定向后cookie也会改变，由于我目前水平较低，暂时无法解决，所以使用了简单但是效率相对低下的Selenium

解决此问题暂时不在目前的更新计划，考虑在夏季学期尝试优化
